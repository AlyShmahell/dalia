t60.

:- dynamic state/2.

senseE(X, L) :> \+ state(_,_), assert(state(X, L)), reportA(generic(X, L)), !.
senseE(X, L) :> state(_,_), retract(state(_,_)), assert(state(X, L)), reportA(generic(X, L)).

alarms(X, L) :- state(_,_), state(X, L), write('testing '), write(X), nl, member(X, [smoke, fire, earthquake]), write('done testing '), write(X), nl.
alarmsI(X, L) :> messageA(coordinator, send_message(alarm(X, L), Me)), retract(state(_,_)).

falarms(X) :- state(_,_), state(X, L), write('testing '), write(X), nl, \+ member(X, [smoke, fire, earthquake]), write('done testing '), write(X), nl.
falarmsI(X) :> reportA(falarm(X, L)), retract(state(_,_)).

reportA(X) :> messageA(logger, send_message(X, Me)).